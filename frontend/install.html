<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Fotobox Ersteinrichtung</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body { background: #f4f6fa; font-family: sans-serif; }
        .setup-container { max-width: 420px; margin: 6vh auto; background: #fff; border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.18); padding: 2.5em 2em 2em 2em; }
        .setup-container h1 { margin-top: 0; }
        .setup-container label { display: block; margin-bottom: 1.2em; font-size: 1.1em; }
        .setup-container input[type=password], .setup-container input[type=text] { width: 100%; padding: 0.7em; font-size: 1.1em; border-radius: 8px; border: 1px solid #bbb; margin-top: 0.5em; }
        .setup-container button { width: 100%; padding: 0.9em; font-size: 1.1em; border-radius: 8px; background: #0078d7; color: #fff; border: none; cursor: pointer; margin-top: 1.2em; }
        .setup-container .hint { color: #666; font-size: 0.98em; margin-bottom: 1.2em; }
        .setup-container .error { color: #c00; margin-bottom: 1em; }
        .setup-container .success { color: #080; margin-bottom: 1em; }
    </style>
</head>
<body>
    <div class="setup-container">
        <h1>Fotobox Ersteinrichtung</h1>
        <form id="setupForm">
            <label>Admin-Passwort setzen:<br>
                <input type="password" id="setupPassword" minlength="4" required autocomplete="new-password">
            </label>
            <div class="hint">Das Passwort sch√ºtzt die Konfigurationsseite. Mindestens 4 Zeichen.</div>
            <button type="submit">Speichern & Starten</button>
            <div id="setupStatus" class="error" style="display:none"></div>
        </form>
    </div>
    <script>
    document.getElementById('setupForm').onsubmit = async function(e) {
        e.preventDefault();
        const pw = document.getElementById('setupPassword').value;
        const status = document.getElementById('setupStatus');
        if(pw.length < 4) {
            status.textContent = 'Passwort zu kurz! (mind. 4 Zeichen)';
            status.className = 'error';
            status.style.display = 'block';
            return;
        }
        // Passwort speichern
        const res = await fetch('/api/settings', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ admin_password: pw })
        });
        if(res.ok) {
            status.textContent = 'Passwort gespeichert! Weiterleitung ...';
            status.className = 'success';
            status.style.display = 'block';
            setTimeout(()=>{ window.location.href = 'capture.html'; }, 1200);
        } else {
            status.textContent = 'Fehler beim Speichern!';
            status.className = 'error';
            status.style.display = 'block';
        }
    };
    </script>
</body>
</html>
