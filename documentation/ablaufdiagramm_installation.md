# Ablaufdiagramm für die Installation (install_fotobox.sh)

<!--
Dieses Diagramm folgt der Policy für Softwarediagramme:
Siehe policies/softwarediagramm_policy.md
-->

+-------------------------------------------------------------------------------+
| Start: Aufruf install_fotobox.sh                                              |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Prüfe Skriptstandort                                                          |
+-------------------------------------------------------------------------------+
| OK                                     | Fehler                               |
+----------------------------------------+--------------------------------------+
|                                        | Abbruch:                             |
|                                        | Skript im Zielverzeichnis            |
+----------------------------------------+--------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Prüfe Root-Rechte                                                             |
+-------------------------------------------------------------------------------+
| OK                                     | Fehler                               |
+----------------------------------------+--------------------------------------+
|                                        | Abbruch:                             |
|                                        | Keine Root-Rechte                    |
+----------------------------------------+--------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Prüfe Distribution                                                            |
+-------------------------------------------------------------------------------+
| OK                                     | Fehler                               |
+----------------------------------------+--------------------------------------+
|                                        | Abbruch:                             |
|                                        | Nicht unterstützte                   |
|                                        | Distribution                         |
+----------------------------------------+--------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Führe apt-get update aus                                                      |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Installiere Systempakete (git, lsof, python3, venv, pip, sqlite3)             |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Lege Benutzer & Gruppe 'fotobox' an                                           |
+-------------------------------------------------------------------------------+
| - useradd -r -M -s /usr/sbin/nologin fotobox                                  |
| - groupadd fotobox                                                            |
| - usermod -aG fotobox fotobox                                                 |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Erstelle Verzeichnisstruktur:                                                 |
| - /opt/fotobox                                                                |
| - /opt/fotobox/backup                                                         |
| - /opt/fotobox/conf                                                           |
| - /opt/fotobox/data                                                           |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Prüfe git, installiere ggf. git                                               |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Klone Projekt-Repository (git clone)                                          |
+-------------------------------------------------------------------------------+
| OK                                     | Fehler                               |
+----------------------------------------+--------------------------------------+
|                                        | Abbruch:                             |
|                                        | Verzeichnisfehler                    |
+----------------------------------------+--------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Setze Ausführbarkeitsrechte für backend/scripts/*.sh                          |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Setze Rechte auf /opt/fotobox (chown -R fotobox:fotobox)                      |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| NGINX-Installation & Konfiguration                                            |
| - Installiere nginx                                                           |
| - manage_nginx.sh install/activ/setport                                       |
| - Portwahl, Default- oder eigene Konfiguration                                |
+-------------------------------------------------------------------------------+
| OK                                     | Fehler                               |
+----------------------------------------+--------------------------------------+
|                                        | Abbruch:                             |
|                                        | NGINX-Fehler                         |
+----------------------------------------+--------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Python-Backend:                                                               |
| - Erstelle venv                                                               |
| - Installiere/aktualisiere pip                                                |
| - Installiere Python-Abhängigkeiten (requirements.txt)                        |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Erzeuge systemd-Service-Datei für Backend                                     |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Kopiere systemd-Service-Datei, aktiviere & starte Service                     |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| NGINX-Konfiguration ausgeben (Status, Port, URL)                              |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Abschluss: Erfolgsmeldung & Weboberfläche                                     |
+-------------------------------------------------------------------------------+
            |
+-------------------------------------------------------------------------------+
| Ende                                                                          |
+-------------------------------------------------------------------------------+

Legende:

- Jeder Schritt ist ein Rechteck.
- Der zu erwartende (OK-)Pfad läuft immer nach unten weiter.
- Fehlerfälle/Austrittspunkte sind nach rechts ausgelagert und klar erkennbar.
- Die Reihenfolge entspricht dem Ablauf von install_fotobox.sh.
- Details zu Systempaketen, Benutzeranlage, Verzeichnisstruktur, Rechte, NGINX und Backend sind jetzt explizit aufgeführt.
- Diagramm- und Formatvorgaben: Siehe policies/softwarediagramm_policy.md
